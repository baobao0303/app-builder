<div class="app-container">
  <!-- Top Bar -->
  <div class="top-bar">
    <div class="logo">
      <h1>{{ title() }}</h1>
    </div>
    <div class="toolbar">
      <button type="button" (click)="undo()" title="Undo">â†¶ Undo</button>
      <button type="button" (click)="redo()" title="Redo">â†· Redo</button>
      <button type="button" (click)="saveProject()" title="Save">ðŸ’¾ Save</button>
      <button type="button" (click)="loadProject()" title="Load">ðŸ“‚ Load</button>
      <button type="button" (click)="exportWithTailwind()" title="Export HTML (Tailwind)">
        ðŸ“¥ Export HTML
      </button>
      <button type="button" (click)="exportPurged()" title="Export Purged (no CDN)">
        ðŸ§¹ Export Purged
      </button>
      <button type="button" (click)="exportCss()" title="Export CSS">ðŸŽ¨ Export CSS</button>
    </div>
  </div>

  <!-- Main Layout -->
  <div class="builder-layout">
    <!-- Left Sidebar: Toolbox -->
    <div class="sidebar-left">
      <div class="panel-header">Components</div>
      <div class="panel-content">
        <app-tool-box (addWidget)="dz.add($event, { append: true })"></app-tool-box>
      </div>
    </div>

    <!-- Center: Canvas -->
    <div class="canvas-area">
      <div class="panel-header">Canvas</div>
      <div class="canvas-content">
        <app-dynamic-zone
          #dz
          [registry]="registry"
          [componentDefinitions]="componentDefinitions"
        ></app-dynamic-zone>
      </div>
    </div>

    <!-- Right Sidebar: Panels -->
    <div class="sidebar-right">
      <!-- Panel Tabs -->
      <div class="panel-tabs">
        <button
          class="tab-button"
          [class.active]="activePanel === 'blocks'"
          (click)="setActivePanel('blocks')"
        >
          Blocks
        </button>
        <button
          class="tab-button"
          [class.active]="activePanel === 'navigator'"
          (click)="setActivePanel('navigator')"
        >
          Layers
        </button>
        <button
          class="tab-button"
          [class.active]="activePanel === 'assets'"
          (click)="setActivePanel('assets')"
        >
          Assets
        </button>
      </div>

      <!-- Panel Content -->
      <div class="panel-content">
        @if (activePanel === 'blocks') {
        <app-block-manager-panel [blocks]="blocks"></app-block-manager-panel>
        } @if (activePanel === 'navigator') {
        <app-navigator-panel [rootComponent]="getRootComponent()"></app-navigator-panel>
        } @if (activePanel === 'assets') {
        <builder-assets-panel></builder-assets-panel>
        }
      </div>
    </div>
  </div>
</div>

<router-outlet />
<builder-modal-host />
<builder-drop-indicator />
